{"type":"pattern","name":"bun-cicd-pattern","description":"CI/CD infrastructure for Bun/TypeScript projects: ci.yml (lint+typecheck+test on push/PR to main via oven-sh/setup-bun@v2), auto-tag.yml (workflow_run trigger after CI success, verifies package.json and src/index.ts versions match before tagging, idempotent tag check). version-bump.ts atomically updates both version locations with rollback on failure. /release command always defaults to patch bump.","classification":"tactical","recorded_at":"2026-02-23T18:46:34.848Z","outcomes":[{"status":"success","agent":"cicd-builder"}],"id":"mx-9b7453"}
{"type":"pattern","name":"bun-ts-extensions-tsconfig","description":"Bun/TS projects need allowImportingTsExtensions:true in tsconfig.json when using .ts import extensions with bundler moduleResolution. Without it, tsc errors with TS5097.","classification":"tactical","recorded_at":"2026-02-23T22:32:01.048Z","outcomes":[{"status":"success","agent":"canopy-builder-2"}],"id":"mx-85ed38"}
{"type":"pattern","name":"jsonl-dedup-pattern","description":"For JSONL stores with multiple record types, use separate dedup functions: dedupById (version-based, last highest version wins) for versioned records like prompts, and dedupByIdLast (insertion order, last wins) for unversioned records like schemas.","classification":"tactical","recorded_at":"2026-02-23T22:32:04.761Z","outcomes":[{"status":"success","agent":"canopy-builder-2"}],"id":"mx-03bd0d"}
{"type":"pattern","name":"greenfield-build-orchestration","description":"Full greenfield build: single lead spawning parallel builders. Builder-2 completed entire canopy (41 files, 3942 LOC, 62 tests) in 28 min. Lesson: for projects with tight internal deps, one comprehensive builder is faster than parallel partial builders. Always merge immediately on merge_ready — previous session lost work by not merging before worktree cleanup.","classification":"tactical","recorded_at":"2026-02-23T22:35:09.138Z","id":"mx-05ac19"}
{"type":"convention","content":"biome.json in Bun/TS projects must ignore tool directories (.beads, .claude, .seeds, .mulch, .overstory) to prevent lint failures on tool-generated config files like metadata.json and settings.json","classification":"tactical","recorded_at":"2026-02-23T22:44:10.630Z","outcomes":[{"status":"success","agent":"cn-build-core"}],"id":"mx-2fbf14"}
{"type":"pattern","name":"canopy-cli-pattern","description":"Canopy CLI: JSONL store with advisory file locking and atomic writes (tmp+rename). 17 commands in src/commands/, tests use process.chdir() for real I/O isolation in tmpdir. biome.json must exclude .beads and .claude dirs. Bun test shares process — process.chdir() in tests can affect tool cwd; always restore in afterEach.","classification":"tactical","recorded_at":"2026-02-23T22:45:16.632Z","outcomes":[{"status":"success","agent":"canopy-builder"}],"id":"mx-3016c1"}
