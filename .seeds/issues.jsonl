{"id":"seeds-fb8b","title":"Foundation + Engine: project scaffold, core data layer, composition engine","status":"closed","type":"feature","priority":1,"createdAt":"2026-02-23T18:42:22.174Z","updatedAt":"2026-02-23T19:02:27.419Z","blocks":["seeds-2d63"],"closedAt":"2026-02-23T19:02:27.419Z","closeReason":"Foundation + Engine complete. Builder implemented: project scaffold (package.json, tsconfig, biome, CI), core data layer (types, store with advisory locking + atomic writes, id generation, yaml parser, config loader, output helpers), composition engine (render with inheritance resolution + cycle detection + depth cap, validate with schema rules), CLI entry with all 17 commands, 61 passing tests, lint clean, typecheck clean. Branch overstory/foundation-builder/seeds-781c ready for merge."}
{"id":"seeds-0290","title":"Infrastructure: CI/CD workflows, scripts, release command, changelog","status":"closed","type":"feature","priority":2,"createdAt":"2026-02-23T18:42:25.768Z","updatedAt":"2026-02-23T18:50:24.770Z","closedAt":"2026-02-23T18:50:24.770Z","closeReason":"Infrastructure complete: 9 files delivered across 2 builders. Config files (package.json, tsconfig.json, biome.json, .gitignore, CHANGELOG.md) and CI/CD files (.github/workflows/ci.yml, auto-tag.yml, scripts/version-bump.ts, .claude/commands/release.md). Both branches merge_ready."}
{"id":"seeds-2d63","title":"CLI + Commands: entry point, all 17 command files, command tests","status":"closed","type":"feature","priority":1,"createdAt":"2026-02-23T18:42:29.958Z","updatedAt":"2026-02-23T22:34:41.893Z","blockedBy":["seeds-fb8b"],"closedAt":"2026-02-23T22:34:41.893Z","closeReason":"CLI + Commands implemented and merged as part of full canopy build (seeds-5503)."}
{"id":"seeds-067b","title":"Build: project config files (package.json, tsconfig, biome, gitignore, changelog)","status":"closed","type":"task","priority":1,"createdAt":"2026-02-23T18:44:14.985Z","updatedAt":"2026-02-23T18:47:28.423Z","closedAt":"2026-02-23T18:47:28.423Z","closeReason":"Config builder delivered package.json, tsconfig.json, biome.json, .gitignore, CHANGELOG.md"}
{"id":"seeds-15a9","title":"Build: CI/CD workflows, version-bump script, release command","status":"closed","type":"task","priority":1,"createdAt":"2026-02-23T18:44:15.547Z","updatedAt":"2026-02-23T18:47:29.336Z","closedAt":"2026-02-23T18:47:29.336Z","closeReason":"CI/CD builder delivered ci.yml, auto-tag.yml, version-bump.ts, release.md"}
{"id":"seeds-781c","title":"Build: project scaffold, core data layer, and composition engine","status":"closed","type":"task","priority":1,"createdAt":"2026-02-23T18:45:49.886Z","updatedAt":"2026-02-23T19:01:45.580Z","closedAt":"2026-02-23T19:01:45.580Z","closeReason":"Implemented complete foundation: scaffold (package.json, tsconfig, biome, CI), core data layer (types, store with locking, id, config, yaml, output), composition engine (render with inheritance, validate with schemas), CLI entry with all 17 commands. 61 tests pass, lint clean, typecheck clean."}
{"id":"seeds-5503","title":"Build canopy: project config, core data layer, composition engine, CLI + all 17 commands, tests","status":"closed","type":"task","priority":1,"createdAt":"2026-02-23T21:55:23.369Z","updatedAt":"2026-02-23T22:34:37.197Z","closedAt":"2026-02-23T22:34:37.197Z","closeReason":"Merged to main. Full implementation complete."}
{"id":"seeds-dfa3","title":"cn import: parse H2 headings into separate sections by default","status":"closed","type":"feature","priority":3,"createdAt":"2026-02-23T23:37:13.973Z","updatedAt":"2026-02-24T00:04:40.471Z","description":"Currently `cn import` puts the entire file into a single 'body' section. It should parse ## headings into separate named sections by default (the --split flag exists but isn't the default), making imported prompts immediately useful for validation and diffing.","closedAt":"2026-02-24T00:04:40.471Z"}
{"id":"seeds-db24","title":"cn create: add --help subcommand help","status":"closed","type":"feature","priority":4,"createdAt":"2026-02-23T23:37:16.897Z","updatedAt":"2026-02-24T00:04:40.471Z","description":"Running `cn create --help` just gives '--name is required' instead of showing available flags for the create command. Each subcommand should support --help to show its own flags.","closedAt":"2026-02-24T00:04:40.471Z"}
{"id":"seeds-0fd2","title":"cn show: display sections in human-readable output","status":"closed","type":"bug","priority":3,"createdAt":"2026-02-23T23:37:19.757Z","updatedAt":"2026-02-24T00:04:40.471Z","description":"The human-readable output of `cn show` only displays name/version/status metadata. Sections (the actual prompt content) are invisible unless you use --json or render. The show command should display sections in human mode too.","closedAt":"2026-02-24T00:04:40.471Z"}
{"id":"seeds-69e6","title":"cn create: --description flag silently ignored","status":"closed","type":"bug","priority":3,"createdAt":"2026-02-23T23:37:23.080Z","updatedAt":"2026-02-24T00:04:40.471Z","description":"Passing --description to cn create is silently ignored — the flag isn't parsed and the Prompt type doesn't have a description field. Either add support or reject the unknown flag.","closedAt":"2026-02-24T00:04:40.471Z"}
{"id":"seeds-d1aa","title":"cn: error messages print twice on stderr","status":"closed","type":"bug","priority":3,"createdAt":"2026-02-23T23:37:25.868Z","updatedAt":"2026-02-24T00:04:40.471Z","description":"Error messages print twice, e.g. '--name is required' followed by another '--name is required'. This appears to happen because errorOut prints once, and then process.exit propagates to the top-level catch which prints again.","closedAt":"2026-02-24T00:04:40.471Z"}
{"id":"seeds-5ab5","title":"Add tests for update command","status":"open","type":"task","priority":1,"createdAt":"2026-02-24T00:20:22.048Z","updatedAt":"2026-02-24T00:20:22.048Z","description":"update.ts is the most complex command (~160 LOC) handling section/tag/metadata mutations. Needs integration tests covering: section add/remove/replace, tag mutations, metadata updates, version bumping. Follow existing anti-mocking pattern with real temp dirs and JSONL files."}
{"id":"seeds-cbc6","title":"Add tests for sync command","status":"open","type":"task","priority":1,"createdAt":"2026-02-24T00:20:24.148Z","updatedAt":"2026-02-24T00:20:24.148Z","description":"sync.ts handles git integration (spawning git, atomic commits). Needs tests for: successful sync, git failure handling, commit message formatting. Use real temp git repos (git init in tmpdir) following mulch's anti-mocking patterns."}
{"id":"seeds-097e","title":"Add tests for list command","status":"open","type":"task","priority":2,"createdAt":"2026-02-24T00:20:25.565Z","updatedAt":"2026-02-24T00:20:25.565Z","description":"list.ts handles filtering prompts by tag, status, and extends. Needs integration tests covering: filter by tag, filter by status, filter by extends/parent, combination filters, --json output, empty results."}
{"id":"seeds-4482","title":"Add tests for archive command","status":"open","type":"task","priority":2,"createdAt":"2026-02-24T00:20:27.295Z","updatedAt":"2026-02-24T00:20:27.295Z","description":"archive.ts handles status transitions (active → archived). Needs tests for: archiving a prompt, unarchiving, archiving already-archived prompt, verifying JSONL state after archive."}
{"id":"seeds-26b6","title":"Add tests for history command","status":"open","type":"task","priority":2,"createdAt":"2026-02-24T00:20:28.329Z","updatedAt":"2026-02-24T00:20:28.329Z","description":"history.ts handles version querying and filtering. Needs tests for: listing versions of a prompt, version pagination/limiting, --json output format."}
{"id":"seeds-28cc","title":"Add tests for pin command","status":"open","type":"task","priority":2,"createdAt":"2026-02-24T00:20:29.484Z","updatedAt":"2026-02-24T00:20:29.484Z","description":"pin.ts handles version pinning and unpinning. Needs tests for: pinning a prompt to a version, unpinning, pinning to nonexistent version, verifying pinned state persists in JSONL."}
{"id":"seeds-28d1","title":"Add tests for show command","status":"open","type":"task","priority":3,"createdAt":"2026-02-24T00:20:30.801Z","updatedAt":"2026-02-24T00:20:30.801Z","description":"show.ts is already tested indirectly through create.test.ts and schema.test.ts. Add standalone tests for: showing specific version, showing nonexistent prompt, --json output, section display formatting."}
{"id":"seeds-fc16","title":"Add tests for tree command","status":"open","type":"task","priority":3,"createdAt":"2026-02-24T00:20:32.080Z","updatedAt":"2026-02-24T00:20:32.080Z","description":"tree.ts handles ancestry/descendant traversal of prompt inheritance. Needs tests for: single parent chain, multiple children, deep hierarchy, orphan prompts, --json output."}
{"id":"seeds-8411","title":"Add concurrent access tests for store locks","status":"open","type":"task","priority":3,"createdAt":"2026-02-24T00:20:33.841Z","updatedAt":"2026-02-24T00:20:33.841Z","description":"store.ts has lock acquire/release tested but not concurrent access patterns. Following mulch's lock.test.ts pattern, add tests for: parallel writes with Promise.all(), stale lock cleanup, lock timeout behavior."}
{"id":"seeds-4b20","title":"Section headings should not be lowercased/slugified","status":"closed","type":"task","priority":2,"createdAt":"2026-02-24T02:48:51.935Z","updatedAt":"2026-02-24T02:51:35.551Z","description":"When importing markdown with `--split`, section headings are lowercased and slugified (e.g. `## Quality Gates` becomes `quality-gates`). This happens at a single point in `src/commands/import.ts:29`:\n\n```ts\ncurrentName = heading.toLowerCase().replace(/\\s+/g, \"-\");\n```\n\nThe slugified name is then stored as-is in JSONL and rendered back verbatim in `cn emit` / `cn show`, so `## Quality Gates` round-trips to `## quality-gates`. This loses the original casing and spacing of the author's headings.\n\nSection names created directly via `cn create --section` are *not* transformed, so there's already an inconsistency.\n\n**Fix:** preserve the original heading text as the section name instead of slugifying it. Update the test in `src/commands/emit.test.ts:115-139` which currently asserts the lowercased behavior.","closedAt":"2026-02-24T02:51:35.551Z"}
{"id":"seeds-f49f","title":"cn init: fix .gitattributes check — skips canopy entries if merge=union already present","status":"open","type":"bug","priority":2,"createdAt":"2026-02-24T02:53:36.002Z","updatedAt":"2026-02-24T02:53:36.002Z","description":"init.ts line 54 checks `existing.includes('merge=union')` which is too broad. If another tool (seeds, mulch) already added merge=union entries for their own JSONL files, canopy's entries are silently skipped. Should check for canopy-specific paths instead (e.g. `.canopy/prompts.jsonl`)."}
{"id":"seeds-0fde","title":"Adopt Commander for CLI parsing","status":"in_progress","type":"feature","priority":1,"createdAt":"2026-02-24T03:29:49.948Z","updatedAt":"2026-02-24T03:40:33.315Z","description":"Replace the manual process.argv parsing (switch statement in src/index.ts, per-command flag helpers) with Commander. Benefits: structured arg/option definitions, auto-generated help, choice validation, built-in version display. Each command in src/commands/ should export a register function. Notable: Canopy has subcommands (schema create/show/list, schema rule add) — Commander supports this via .command().command() nesting. Business logic stays untouched — only parsing/routing changes.","blocks":["seeds-787b","seeds-3162"]}
{"id":"seeds-787b","title":"Adopt chalk for output formatting","status":"open","type":"feature","priority":1,"createdAt":"2026-02-24T03:29:52.109Z","updatedAt":"2026-02-24T03:29:57.676Z","description":"Replace raw ANSI codes in src/output.ts with chalk. Currently using manual NO_COLOR/TTY detection and c.bold/c.dim/c.green/c.red/c.yellow/c.cyan/c.blue helpers. Chalk handles terminal capability detection automatically. Preserve the humanOut/jsonOut/errorOut helper pattern but use chalk underneath. Success: ✔ (green). Errors: 'Error:' prefix (red).","blockedBy":["seeds-0fde"]}
{"id":"seeds-3162","title":"Use process.exitCode instead of process.exit()","status":"open","type":"feature","priority":2,"createdAt":"2026-02-24T03:29:54.919Z","updatedAt":"2026-02-24T03:29:57.694Z","description":"Canopy has a custom ExitError class and uses both process.exit(1) and throw ExitError(1). Switch to process.exitCode = 1 for testability. The ExitError class can remain for internal flow control but the top-level handler should set process.exitCode rather than calling process.exit(). Standardize JSON error shape to { success: false, command, error }.","blockedBy":["seeds-0fde"]}
{"id":"seeds-5cc2","title":"Core: install commander, rewrite index.ts, migrate simple commands","status":"in_progress","type":"task","priority":1,"createdAt":"2026-02-24T03:58:41.588Z","updatedAt":"2026-02-24T03:58:51.046Z","description":"Install commander package. Rewrite src/index.ts to use Commander program with register pattern. Migrate simple commands (init, show, list, archive, history, tree, stats, sync, diff, render) to export register(program) functions. Each command keeps its default() export for test compatibility."}
{"id":"seeds-625b","title":"Migrate complex commands to Commander","status":"in_progress","type":"task","priority":1,"createdAt":"2026-02-24T03:58:43.501Z","updatedAt":"2026-02-24T03:58:55.917Z","description":"Migrate complex commands to Commander register pattern: create, update, emit, pin/unpin, schema (with subcommands create/show/list/rule-add), validate, import, prime, onboard. Handle repeatable flags, subcommand nesting, and preserve existing behavior."}
{"id":"seeds-3c3c","title":"Fix typecheck: install commander types and add opts type annotations","status":"in_progress","type":"bug","priority":1,"createdAt":"2026-02-24T04:14:23.291Z","updatedAt":"2026-02-24T04:14:30.452Z","description":"After Commander migration merge, typecheck fails: (1) commander module not found - needs bun install, (2) implicit any on opts parameters in create.ts:186, emit.ts:242, import.ts:178, onboard.ts:145, prime.ts:167, schema.ts:304+338, update.ts:212, validate.ts:159. Fix: bun install to get commander types, then add explicit type annotations to all opts params."}
{"id":"seeds-6205","title":"Fix typecheck: bun install + opts type annotations","status":"open","type":"bug","priority":1,"createdAt":"2026-02-24T04:21:09.415Z","updatedAt":"2026-02-24T04:21:09.415Z","description":"Run bun install and add Record<string, unknown> type to 9 opts params in Commander action callbacks"}
